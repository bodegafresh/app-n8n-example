<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DOJO · Wing Chun · n8n</title>
  <meta name="description" content="Demo con estética Bruce Lee/Wing Chun: botón que invoca un webhook de n8n y muestra la respuesta.">

  <style>
    /* Paleta Bruce Lee (amarillo/negro) */
    :root{
      --bg:#0a0a0a;
      --panel:#111317;
      --ink:#0c0c0c;
      --text:#f6f7f9;
      --muted:#c7c9cf;
      --gold:#f7c325;       /* traje amarillo icónico */
      --gold-2:#ffde59;
      --accent:#111;        /* franjas negras */
      --ok:#16a34a;
      --err:#ef4444;
      --ring: rgba(247, 195, 37, .35);
    }

    html,body{height:100%}
    body{
      margin:0;
      background:
        radial-gradient(1200px 700px at 80% -20%, rgba(247,195,37,.08), transparent 60%),
        radial-gradient(900px 600px at -10% 120%, rgba(247,195,37,.06), transparent 60%),
        var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, sans-serif;
      display:grid; place-items:center; padding:24px;
      overflow-x:hidden;
    }

    /* Banda diagonal negra sobre franja amarilla (tracksuit vibes) */
    .stripe{
      position:fixed; inset:0; pointer-events:none; z-index:-1;
      background:
        linear-gradient(160deg, transparent 0 38%, var(--gold) 38% 42%, transparent 42% 100%),
        linear-gradient(160deg, transparent 0 40%, var(--accent) 40% 46%, transparent 46% 100%);
      opacity:.45;
      filter:saturate(1.1);
    }

    .wrap{ width:min(980px, 94vw); }

    /* Marca + ideograma */
    .head{
      display:flex; align-items:center; gap:14px; margin:0 0 12px 0;
      letter-spacing:.2px;
    }
    .seal{
      width:44px; height:44px; border-radius:10px;
      background: radial-gradient(circle at 30% 25%, var(--gold-2), var(--gold));
      box-shadow: 0 6px 28px rgba(247,195,37,.15), inset 0 0 0 2px rgba(0,0,0,.35);
      display:grid; place-items:center;
    }
    .seal svg{ width:26px; height:26px; }

    .dojo{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.1);
      border-radius:18px; padding:26px;
      box-shadow: 0 24px 60px rgba(0,0,0,.25);
      position:relative;
      overflow:hidden;
    }

    /* Agua de tinta (brush) */
    .dojo::before{
      content:"詠春"; /* Wing Chun */
      position:absolute; right:-8px; top:-8px;
      font-size:140px; line-height:1;
      color:rgba(255,255,255,.04);
      font-family: "Georgia", "Times New Roman", serif;
      transform: rotate(-10deg);
      user-select:none; pointer-events:none;
    }

    h1{margin:0; font-size:clamp(22px,3.2vw,28px)}
    .lead{margin:6px 0 18px 0; color:var(--muted)}

    .grid{display:grid; grid-template-columns: 1.15fr 1fr; gap:18px}
    @media (max-width:920px){ .grid{ grid-template-columns:1fr } }

    .panel{
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.1);
      border-radius:14px; padding:16px;
    }

    /* Botón con “cinta” de cinturón */
    .actions{ display:flex; align-items:center; gap:12px; flex-wrap:wrap }
    .btn{
      appearance:none; border:0; border-radius:12px; padding:12px 16px; font-weight:700;
      color:#0a0a0a; background:linear-gradient(135deg, var(--gold), var(--gold-2));
      box-shadow: 0 8px 20px rgba(247,195,37,.25), inset 0 -2px 0 rgba(0,0,0,.2);
      cursor:pointer; transition: transform .1s ease, filter .2s ease, box-shadow .2s ease;
      position:relative; isolation:isolate;
    }
    .btn::after{
      /* cinta negra al centro */
      content:""; position:absolute; inset:50% -10px auto -10px; height:4px; background:var(--accent);
      transform: translateY(-50%); border-radius:999px; z-index:-1; opacity:.85;
    }
    .btn:hover{ transform: translateY(-1px); filter:brightness(1.05) }
    .btn:active{ transform: translateY(0) scale(.98) }
    .btn[disabled]{ opacity:.65; cursor:progress }

    /* Nunchaku mini como spinner */
    .nun{ display:inline-grid; grid-auto-flow:column; gap:3px; transform-origin:center; animation:swirl .9s linear infinite }
    .bar{ width:6px; height:14px; background:#0a0a0a; border-radius:2px }
    .chain{ width:6px; height:6px; border:2px solid #0a0a0a; border-radius:50% }
    @keyframes swirl{ to{ transform:rotate(360deg) } }

    .status{ color:var(--muted); font-size:14px }
    .dot{ width:10px; height:10px; border-radius:999px; display:inline-block; vertical-align:middle; margin-right:6px }
    .ok{ background:var(--ok) } .err{ background:var(--err) } .idle{ background:#8886 }

    .result{
      font: 14px ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      background:#0b0d11; border:1px dashed rgba(255,255,255,.16);
      border-radius:12px; padding:14px; min-height:56px; white-space:pre-wrap;
      box-shadow: inset 0 0 14px rgba(0,0,0,.35);
    }

    .note{
      margin-top:10px; font-size:12px; color:var(--muted)
    }

    .btn:focus-visible{ outline:3px solid var(--ring); outline-offset:2px }
    a:focus-visible{ outline:3px solid var(--ring); outline-offset:2px; border-radius:8px }
  </style>
</head>
<body>
  <div class="stripe" aria-hidden="true"></div>

  <div class="wrap">
    <div class="head">
      <div class="seal" aria-hidden="true">
        <!-- puño estilizado -->
        <svg viewBox="0 0 24 24" fill="none" role="img" aria-label="Fist">
          <path d="M5 11c0-2 1-3 3-3h1M9 8h2M11 8h2M13 8h2c2 0 3 1 3 3v3c0 3-2 5-5 5H9c-3 0-5-2-5-5v-1" stroke="#0a0a0a" stroke-width="2" />
        </svg>
      </div>
      <div>
        <h1>DOJO · Wing Chun · n8n</h1>
        <div class="lead">Velocidad y precisión: la web consulta un <strong>webhook</strong> y muestra su respuesta.</div>
      </div>
    </div>

    <div class="dojo">
      <div class="grid">
        <section class="panel">
          <h3 style="margin:0 0 8px">Técnica</h3>
          <p class="status" id="status"><span class="dot idle"></span>Listo</p>

          <div class="actions" style="margin-top:10px">
            <button class="btn" id="btn" type="button">
              <span id="btnText">Aplicar golpe (llamar n8n)</span>
            </button>
          </div>

          <p class="note">Acción: esta app hace <code>GET /api/hola</code> y el servidor reenvía un <code>POST</code> al webhook de n8n.</p>
        </section>

        <section class="panel">
          <h3 style="margin:0 0 8px">Resultado</h3>
          <div id="out" class="result" aria-live="polite"></div>
        </section>
      </div>
    </div>

    <p class="note" style="text-align:center;margin-top:14px">Inspirado en el espíritu de Bruce Lee y el Wing Chun. Demo técnica.</p>
  </div>

  <script>
    const btn = document.getElementById("btn");
    const btnText = document.getElementById("btnText");
    const out = document.getElementById("out");
    const statusEl = document.getElementById("status");

    function setStatus(kind, text){
      const color = kind === "ok" ? "var(--ok)" : kind === "err" ? "var(--err)" : "#8886";
      statusEl.innerHTML = `<span class="dot" style="background:${color}"></span>${text}`;
    }

    async function callN8n(){
      btn.disabled = true;
      btnText.innerHTML = `<span class="nun" aria-hidden="true"><span class="bar"></span><span class="chain"></span><span class="bar"></span></span> Ejecutando…`;
      setStatus("idle","Llamando al webhook");
      out.textContent = "";

      try{
        const r = await fetch("/api/hola");
        const txt = await r.text();
        if(!r.ok){
          setStatus("err","Error");
          out.textContent = `⚠️ n8n devolvió ${r.status}:\n${txt}`;
        }else{
          setStatus("ok","Éxito");
          out.textContent = txt; // “hola mundo”
        }
      }catch(e){
        setStatus("err","Fallo de red");
        out.textContent = "❌ Error llamando a n8n: " + e.message;
      }finally{
        btn.disabled = false;
        btnText.textContent = "Aplicar golpe (llamar n8n)";
      }
    }

    btn.addEventListener("click", callN8n);
  </script>
</body>
</html>
