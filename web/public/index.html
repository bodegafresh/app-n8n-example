<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MVP · n8n + Webhook</title>
  <meta name="description" content="Demo profesional: botón que llama a un webhook de n8n y muestra la respuesta." />
  <style>
    :root{
      --bg: #0b1020;
      --card: rgba(255,255,255,.08);
      --text: #e8eefc;
      --muted:#9fb0d0;
      --brand:#6aa7ff;
      --brand-2:#7bffcf;
      --danger:#ff6b6b;
      --ok:#22c55e;
      --ring: rgba(122, 162, 247, .45);
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg: #f4f7ff;
        --card: rgba(255,255,255,.9);
        --text: #0c1a34;
        --muted:#5b6b85;
        --brand:#2563eb;
        --brand-2:#06b6d4;
        --danger:#e11d48;
        --ok:#16a34a;
        --ring: rgba(37, 99, 235, .25);
      }
    }

    /* Background gradient + orbes */
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, sans-serif;
      color:var(--text); background: radial-gradient(1200px 800px at 80% -20%, #1b2b65 0%, transparent 60%), radial-gradient(900px 700px at -10% 110%, #0f766e 0%, transparent 60%), var(--bg);
      display:grid; place-items:center; padding:24px;
    }

    .wrap{ width:min(940px, 92vw); position:relative; }
    .brand{
      display:flex; align-items:center; gap:12px; margin-bottom:18px;
      letter-spacing:.2px;
    }
    .brand svg{ width:32px; height:32px; }
    .badge{ font-size:12px; color:var(--muted); border:1px solid rgba(255,255,255,.15); padding:4px 8px; border-radius:999px; }

    .card{
      background: var(--card); backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,.12);
      border-radius:20px; padding:28px; box-shadow: 0 20px 50px rgba(0,0,0,.25);
    }

    h1{ margin:0 0 8px 0; font-size: clamp(22px, 3.2vw, 28px); }
    p.lead{ margin:0 0 20px 0; color:var(--muted) }

    .row{ display:flex; gap:20px; flex-wrap:wrap }
    .col{ flex:1 1 320px }

    .panel{
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.12);
      border-radius:16px; padding:18px;
    }

    /* Botón primario */
    .actions{ display:flex; align-items:center; gap:12px; flex-wrap:wrap }
    .btn{
      appearance:none; border:0; border-radius:12px; padding:12px 16px;
      font-weight:600; cursor:pointer;
      color:#0b1020; background: linear-gradient(135deg, var(--brand), var(--brand-2));
      box-shadow: 0 6px 18px rgba(0,0,0,.25);
      transition: transform .12s ease, box-shadow .2s ease, filter .2s ease;
    }
    .btn:hover{ transform: translateY(-1px); filter: brightness(1.05) }
    .btn:active{ transform: translateY(0) scale(.98) }
    .btn[disabled]{ opacity:.6; cursor:progress; }

    .dot{ width:10px; height:10px; border-radius:999px; display:inline-block; vertical-align:middle; margin-right:6px; }
    .ok { background:var(--ok) }
    .err{ background:var(--danger) }
    .muted{ color:var(--muted) }

    /* Área de resultado */
    .result{
      font: 14px ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      background: rgba(0,0,0,.35);
      border:1px dashed rgba(255,255,255,.2);
      border-radius:12px; padding:14px; min-height:52px; white-space:pre-wrap;
    }

    /* Spinner */
    .spinner{ width:16px; height:16px; border-radius:50%; border:2px solid rgba(255,255,255,.35); border-top-color:#fff; animation:spin .8s linear infinite; display:inline-block; vertical-align:-3px; margin-right:8px }
    @keyframes spin{ to{ transform:rotate(360deg)}}

    footer{
      margin-top:16px; text-align:center; color:var(--muted); font-size:12px;
    }

    /* Focus rings accesibles */
    .btn:focus-visible, a:focus-visible{ outline: 3px solid var(--ring); outline-offset: 2px; border-radius:12px }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="brand">
      <!-- Logo simple -->
      <svg viewBox="0 0 32 32" fill="none" aria-hidden="true">
        <defs>
          <linearGradient id="g" x1="0" y1="0" x2="32" y2="32" gradientUnits="userSpaceOnUse">
            <stop stop-color="#6aa7ff"/><stop offset="1" stop-color="#7bffcf"/>
          </linearGradient>
        </defs>
        <rect x="2" y="2" width="28" height="28" rx="8" fill="url(#g)"/>
        <path d="M10 17h12M10 11h8M10 23h6" stroke="#0b1020" stroke-width="2" stroke-linecap="round"/>
      </svg>
      <div>
        <div class="badge">Demo SaaS</div>
        <h1>MVP · n8n + Webhook</h1>
      </div>
    </div>

    <div class="card">
      <p class="lead">Al pulsar el botón, el servidor consulta un workflow en <strong>n8n</strong> y muestra la respuesta.</p>

      <div class="row">
        <div class="col panel">
          <h3 style="margin:0 0 10px 0;">Acción</h3>
          <p class="muted" style="margin:0 0 12px">Usa el endpoint <code>/api/hola</code> de esta app, que a su vez invoca el webhook de n8n.</p>
          <div class="actions">
            <button id="btn" class="btn" type="button">
              <span id="btnText">Llamar a n8n</span>
            </button>
            <span id="status" class="muted"><span class="dot" style="background:#a5b4fc"></span>Listo</span>
          </div>
        </div>

        <div class="col panel">
          <h3 style="margin:0 0 10px 0;">Resultado</h3>
          <div id="out" class="result" aria-live="polite"></div>
        </div>
      </div>
    </div>

    <footer>© Tu Empresa — Demo técnico</footer>
  </div>

  <script>
    const btn = document.getElementById("btn");
    const btnText = document.getElementById("btnText");
    const out = document.getElementById("out");
    const statusEl = document.getElementById("status");

    function setStatus(kind, text){
      const color = kind === "ok" ? "var(--ok)" : kind === "err" ? "var(--danger)" : "#a5b4fc";
      statusEl.innerHTML = `<span class="dot" style="background:${color}"></span>${text}`;
    }

    async function callN8n(){
      btn.disabled = true;
      btnText.innerHTML = `<span class="spinner"></span>Llamando…`;
      setStatus("muted","Llamando al webhook");
      out.textContent = "";

      try{
        const r = await fetch("/api/hola", { method: "GET" });
        const txt = await r.text();
        if(!r.ok){
          setStatus("err","Error");
          out.textContent = `⚠️ n8n devolvió ${r.status}:\n${txt}`;
        }else{
          setStatus("ok","Éxito");
          out.textContent = txt; // ← “hola mundo”
        }
      }catch(e){
        setStatus("err","Fallo de red");
        out.textContent = "❌ Error llamando a n8n: " + e.message;
      }finally{
        btn.disabled = false;
        btnText.textContent = "Llamar a n8n";
      }
    }

    btn.addEventListener("click", callN8n);
  </script>
</body>
</html>
